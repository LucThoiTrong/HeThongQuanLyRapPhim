<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle}">Invoice Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container">
    <h2 th:text="${pageTitle}">Chi tiết hóa đơn.</h2>

    <div th:if="${errorMessage}" class="alert alert-danger">
        <span th:text="${errorMessage}"></span>
    </div>

    <h4>Thông tin hóa đơn</h4>
    <table class="table table-bordered">
        <tr>
            <th>Mã hóa đơn</th>
            <td th:text="${hoaDon.idHoaDon}"></td>
        </tr>
        <tr>
            <th>Tổng hóa đơn</th>
            <td th:text="${hoaDon.tongGiaTien}"></td>
        </tr>
        <tr>
            <th>Trạng thái</th>
            <td th:text="${hoaDon.trangThaiHoaDon}"></td>
        </tr>
        <tr>
            <th>Ngày thanh toán</th>
            <td th:text="${#temporals.format(hoaDon.ngayThanhToan, 'dd/MM/yyyy HH:mm')}"></td>
        </tr>
        <tr>
            <th>Ngày giờ chiếu</th>
            <td th:text="${#temporals.format(hoaDon.suatChieu.ngayGioChieu, 'dd/MM/yyyy HH:mm')}"></td>
        </tr>
    </table>

    <h4>Thông tin vé</h4>
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Số ghế</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="ticket : ${hoaDon.dsVeXemPhimDaMua}">
            <td th:text="${ticket.ghe.dayGhe.tenDayGhe + '-' + ticket.ghe.idGhe}"></td>
        </tr>
        </tbody>
    </table>

    <h4>Combo</h4>
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Tên Combo</th>
            <th>Số Lượng</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="combo : ${hoaDon.dsChiTietComBoDaMua}" th:if="${hoaDon.dsChiTietComBoDaMua}">
            <td th:text="${combo.comboBapNuoc.tenCombo}"></td>
            <td th:text="${combo.soLuong}"></td>
        </tr>
        </tbody>
    </table>

    <h4>Hoàn trả vé</h4>
    <form th:action="@{/refund/thuc-hien-hoan-tra/{id}(id=${hoaDon.idHoaDon})}" method="get">
        <input type="hidden" name="idHoaDon" th:value="${hoaDon.idHoaDon}">
        <div class="mb-3">
            <label for="lyDoHoanTra" class="form-label">Lý do hoàn trả vé</label>
            <textarea class="form-control" id="lyDoHoanTra" name="lyDoHoanTra" rows="4" required></textarea>
        </div>
        <button type="submit" class="btn btn-primary"
                th:if="${hoaDon.trangThaiHoaDon == T(hcmute.edu.vn.HeThongQuanLyRapPhim.model.TrangThaiHoaDon).DA_THANH_TOAN}">
            Xác nhận hoàn trả
        </button>

        <a th:href="@{/refund/danh-sach-hoa-don}" class="btn btn-secondary">Quay lại</a>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>